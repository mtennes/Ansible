---
- hosts: localhost
  connection: local
  become: true
  gather_facts: false
  vars:
    env: dev
    TFENV_ARCH: amd64
  tasks:
    - name: Ensures taps are present via homebrew
      community.general.homebrew_tap:
        name: "{{ item }}"
        state: present
      with_items:
        - hashicorp/tap
    - name: Ensures packages are present via homebrew cask
      community.general.homebrew_cask:
        name: "{{ item }}"
        state: present
        install_options: appdir=/Applications
      with_items:
        - karabiner-elements
        - 1password
        - ansible
    - name: Ensures packages are present via homebrew
      community.general.homebrew:
        name: "{{ item }}"
        path: /Applications
        state: present
      with_items:
        - openssl
        - 1password-cli
        - xz
        - zlib
        - wget
        - fzf
        - ansible-lint
      ignore_errors: yes
      tags:
        - packages
